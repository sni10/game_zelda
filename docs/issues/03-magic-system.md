# Issue #03: –°–∏—Å—Ç–µ–º–∞ –º–∞–≥–∏–∏ –∏ —Å—Ç–∏—Ö–∏–π

## –û–ø–∏—Å–∞–Ω–∏–µ
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –º–∞–≥–∏–∏ —Å —Ç—Ä–µ–º—è —Å—Ç–∏—Ö–∏—è–º–∏ (–û–≥–æ–Ω—å, –•–æ–ª–æ–¥, –ú–æ–ª–Ω–∏—è), —Å–∏—Å—Ç–µ–º–æ–π –º–∞–Ω—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π.

## –¶–µ–ª—å
–î–æ–±–∞–≤–∏—Ç—å –º–∞–≥–∏—á–µ—Å–∫—É—é –±–æ–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∫–∞–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –∞—Ç–∞–∫–∞–º, —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ –∏ —Ç–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–∞ –º–∞–Ω—ã
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞–Ω—ã –∫ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º –∏–≥—Ä–æ–∫–∞
- [ ] –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–∞–Ω–∞: 100 MP (—É–ª—É—á—à–∞–µ—Ç—Å—è –Ω–∞–≤—ã–∫–∞–º–∏)
- [ ] –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞–Ω—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
- [ ] –ü–æ–ª–æ—Å–∫–∞ –º–∞–Ω—ã –≤ UI (—Å–∏–Ω–µ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç)
- [ ] –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –≤ –º–∞–Ω–µ

### –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —Å—Ç–∏—Ö–∏–∏
- [ ] **–û–≥–æ–Ω—å**:
  - [ ] –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–Ω + –¥–µ–±–∞—Ñ –≥–æ—Ä–µ–Ω–∏—è
  - [ ] –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ —Ö–æ–ª–æ–¥–∞
  - [ ] –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã: –∫—Ä–∞—Å–Ω–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–µ —á–∞—Å—Ç–∏—Ü—ã
- [ ] **–•–æ–ª–æ–¥**:
  - [ ] –ë–∞–∑–æ–≤—ã–π —É—Ä–æ–Ω + –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
  - [ ] –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ –æ–≥–Ω—è
  - [ ] –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã: —Å–∏–Ω–µ-–±–µ–ª—ã–µ –∫—Ä–∏—Å—Ç–∞–ª–ª—ã
- [ ] **–ú–æ–ª–Ω–∏—è**:
  - [ ] –í—ã—Å–æ–∫–∏–π —É—Ä–æ–Ω + –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ü–µ–ø–Ω–æ–π —Ä–µ–∞–∫—Ü–∏–∏
  - [ ] –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–ø–∞–¥–∞–Ω–∏–µ
  - [ ] –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã: –∂–µ–ª—Ç–æ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–µ —Ä–∞–∑—Ä—è–¥—ã

### –¢–∏–ø—ã –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫
- [ ] **–î–∞–ª—å–Ω–∏–π —É—Ä–æ–Ω**:
  - [ ] –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —Å–Ω–∞—Ä—è–¥—ã
  - [ ] –õ—É—á–∏ –∏ –º–æ–ª–Ω–∏–∏
  - [ ] –î–∞–ª—å–Ω–æ—Å—Ç—å: –±–æ–ª—å—à–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫
- [ ] **–ë–ª–∏–∂–Ω–∏–π —É—Ä–æ–Ω**:
  - [ ] –ú–∞–≥–∏—á–µ—Å–∫–∏–µ –≤–∑—Ä—ã–≤—ã –≤–æ–∫—Ä—É–≥ –∏–≥—Ä–æ–∫–∞
  - [ ] –£—Å–∏–ª–µ–Ω–∏–µ –æ—Ä—É–∂–∏—è —Å—Ç–∏—Ö–∏—è–º–∏
  - [ ] –ó–∞—â–∏—Ç–Ω—ã–µ –∞—É—Ä—ã

### –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] **–î–≤–µ —Ä—É–∫–∏ - –¥–≤–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è**:
  - [ ] –ö–∞–∂–¥–∞—è —Ä—É–∫–∞ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Å—Ç–∏—Ö–∏–∏
  - [ ] –ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π —Ä—É–∫–∏
- [ ] **–ö–æ–º–±–æ-—ç—Ñ—Ñ–µ–∫—Ç—ã**:
  - [ ] –û–≥–æ–Ω—å + –•–æ–ª–æ–¥ = –ü–∞—Ä–æ–≤–æ–π –≤–∑—Ä—ã–≤ (—Å—É–ø–µ—Ä —É—Ä–æ–Ω)
  - [ ] –û–≥–æ–Ω—å + –ú–æ–ª–Ω–∏—è = –ü–ª–∞–∑–º–µ–Ω–Ω—ã–π —Ä–∞–∑—Ä—è–¥
  - [ ] –•–æ–ª–æ–¥ + –ú–æ–ª–Ω–∏—è = –õ–µ–¥—è–Ω–∞—è –±—É—Ä—è
- [ ] **–°—É–ø–µ—Ä–º–∞–≥ —Ä–µ–∂–∏–º**:
  - [ ] –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±–µ–∏—Ö —Ä—É–∫
  - [ ] –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –º–∞–Ω—ã
  - [ ] –£—Å–∏–ª–µ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

#### ECS Components –¥–ª—è –º–∞–≥–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã
```python
# src/core/ecs/magic_components.py
class MagicComponent(Component):
    """–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π"""
    def __init__(self, max_mana: int = 100):
        self.max_mana = max_mana
        self.current_mana = max_mana
        self.mana_regen_rate = 1.0
        self.known_spells = set()
        self.active_effects = []

class SpellComponent(Component):
    """–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è"""
    def __init__(self, spell_id: str, element: str, mana_cost: int):
        self.spell_id = spell_id
        self.element = element  # fire, cold, lightning
        self.mana_cost = mana_cost
        self.cooldown = 0
        self.damage = 0
        self.range = 0
        self.duration = 0

class ElementalResistanceComponent(Component):
    """–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–π –∫ —Å—Ç–∏—Ö–∏—è–º"""
    def __init__(self):
        self.resistances = {
            'fire': 0.0,     # 0.0 = –Ω–µ—Ç —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è, 0.5 = 50% —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
            'cold': 0.0,
            'lightning': 0.0
        }

class HandSlotComponent(Component):
    """–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–ª–æ—Ç–æ–≤ —Ä—É–∫ –¥–ª—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π"""
    def __init__(self):
        self.left_hand = None   # SpellComponent –∏–ª–∏ WeaponComponent
        self.right_hand = None
        self.can_dual_cast = True
```

#### Strategy Pattern –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –º–∞–≥–∏–∏
```python
# src/magic/spell_strategies.py
class SpellStrategy(ABC):
    """–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è"""
    
    @abstractmethod
    def cast(self, caster: Entity, target_pos: tuple, world: World) -> bool:
        pass
    
    @abstractmethod
    def calculate_damage(self, caster: Entity, target: Entity) -> float:
        pass

class ProjectileSpellStrategy(SpellStrategy):
    """–°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è —Å–Ω–∞—Ä—è–¥–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (–æ–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä, –ª–µ–¥—è–Ω–∞—è —Å—Ç—Ä–µ–ª–∞)"""
    def cast(self, caster: Entity, target_pos: tuple, world: World) -> bool:
        spell_comp = caster.get_component(SpellComponent)
        magic_comp = caster.get_component(MagicComponent)
        
        if magic_comp.current_mana >= spell_comp.mana_cost:
            # –°–æ–∑–¥–∞–µ–º —Å–Ω–∞—Ä—è–¥
            projectile = self._create_projectile(caster, target_pos, spell_comp)
            world.add_entity(projectile)
            magic_comp.current_mana -= spell_comp.mana_cost
            return True
        return False

class InstantSpellStrategy(SpellStrategy):
    """–°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (—É–¥–∞—Ä –º–æ–ª–Ω–∏–∏)"""
    def cast(self, caster: Entity, target_pos: tuple, world: World) -> bool:
        # –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø–æ–ø–∞–¥–∞–Ω–∏–µ –±–µ–∑ —Å–Ω–∞—Ä—è–¥–∞
        targets = self._find_targets_in_line(caster, target_pos, world)
        for target in targets:
            damage = self.calculate_damage(caster, target)
            self._apply_damage(target, damage)
        return True

class AuraSpellStrategy(SpellStrategy):
    """–°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –∞—É—Ä–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (—â–∏—Ç—ã, —É—Å–∏–ª–µ–Ω–∏—è)"""
    def cast(self, caster: Entity, target_pos: tuple, world: World) -> bool:
        # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –Ω–∞ –∫–∞—Å—Ç–µ—Ä–µ
        aura_effect = self._create_aura_effect(caster)
        magic_comp = caster.get_component(MagicComponent)
        magic_comp.active_effects.append(aura_effect)
        return True

class ComboSpellStrategy(SpellStrategy):
    """–°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π"""
    def __init__(self, left_strategy: SpellStrategy, right_strategy: SpellStrategy):
        self.left_strategy = left_strategy
        self.right_strategy = right_strategy
        self.combo_effects = {
            ('fire', 'cold'): 'steam_explosion',
            ('fire', 'lightning'): 'plasma_burst',
            ('cold', 'lightning'): 'ice_storm'
        }
    
    def cast(self, caster: Entity, target_pos: tuple, world: World) -> bool:
        # –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–≤—É—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π —Å –∫–æ–º–±–æ-—ç—Ñ—Ñ–µ–∫—Ç–æ–º
        left_element = self._get_element(self.left_strategy)
        right_element = self._get_element(self.right_strategy)
        
        combo_type = self.combo_effects.get((left_element, right_element))
        if combo_type:
            return self._cast_combo_spell(caster, target_pos, world, combo_type)
        else:
            # –û–±—ã—á–Ω–æ–µ –¥–≤–æ–π–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
            return (self.left_strategy.cast(caster, target_pos, world) and
                   self.right_strategy.cast(caster, target_pos, world))
```

#### Decorator Pattern –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
```python
# src/magic/spell_decorators.py
class SpellModifier(ABC):
    """–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π"""
    def __init__(self, spell_strategy: SpellStrategy):
        self._spell_strategy = spell_strategy
    
    @abstractmethod
    def cast(self, caster: Entity, target_pos: tuple, world: World) -> bool:
        pass

class PowerfulSpellModifier(SpellModifier):
    """–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Å–∏–ª—ã –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è"""
    def __init__(self, spell_strategy: SpellStrategy, power_multiplier: float):
        super().__init__(spell_strategy)
        self.power_multiplier = power_multiplier
    
    def cast(self, caster: Entity, target_pos: tuple, world: World) -> bool:
        # –í—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∏–ª—É –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è
        original_damage = self._get_spell_damage(caster)
        self._set_spell_damage(caster, original_damage * self.power_multiplier)
        
        result = self._spell_strategy.cast(caster, target_pos, world)
        
        # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å–∏–ª—É
        self._set_spell_damage(caster, original_damage)
        return result

class ExtendedRangeModifier(SpellModifier):
    """–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É–≤–µ–ª–∏—á–µ–Ω–∏—è –¥–∞–ª—å–Ω–æ—Å—Ç–∏"""
    def __init__(self, spell_strategy: SpellStrategy, range_multiplier: float):
        super().__init__(spell_strategy)
        self.range_multiplier = range_multiplier

class ManaCostReductionModifier(SpellModifier):
    """–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–Ω–∏–∂–µ–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –º–∞–Ω—ã"""
    def __init__(self, spell_strategy: SpellStrategy, cost_reduction: float):
        super().__init__(spell_strategy)
        self.cost_reduction = cost_reduction  # 0.2 = 20% —Å–Ω–∏–∂–µ–Ω–∏–µ
```

#### Observer Pattern –¥–ª—è –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
```python
# src/events/magic_events.py
class SpellCastEvent(GameEvent):
    """–°–æ–±—ã—Ç–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è"""
    def __init__(self, caster: Entity, spell: SpellComponent, target_pos: tuple):
        super().__init__("spell_cast")
        self.caster = caster
        self.spell = spell
        self.target_pos = target_pos

class ManaChangedEvent(GameEvent):
    """–°–æ–±—ã—Ç–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–∞–Ω—ã"""
    def __init__(self, entity: Entity, old_mana: int, new_mana: int):
        super().__init__("mana_changed")
        self.entity = entity
        self.old_mana = old_mana
        self.new_mana = new_mana

class ComboSpellEvent(GameEvent):
    """–°–æ–±—ã—Ç–∏–µ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è"""
    def __init__(self, caster: Entity, combo_type: str, elements: tuple):
        super().__init__("combo_spell")
        self.caster = caster
        self.combo_type = combo_type
        self.elements = elements

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ö
class MagicSystem(System):
    def __init__(self, event_system: EventSystem):
        self.event_system = event_system
        self.event_system.subscribe("spell_cast", self.handle_spell_cast)
        self.event_system.subscribe("combo_spell", self.handle_combo_spell)
    
    def handle_spell_cast(self, event: SpellCastEvent):
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–µ—Å—Ç–æ–≤, –ø—Ä–æ–∫–∞—á–∫–∞ –Ω–∞–≤—ã–∫–æ–≤
        self._update_magic_skill(event.caster, event.spell.element)
        self._check_spell_achievements(event.caster, event.spell)
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

#### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
```
src/
‚îú‚îÄ‚îÄ core/ecs/
‚îÇ   ‚îî‚îÄ‚îÄ magic_components.py       # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–∞–≥–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ magic/
‚îÇ   ‚îú‚îÄ‚îÄ spell_strategies.py       # –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ spell_decorators.py       # –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ magic_system.py           # –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞–≥–∏–∏ (ECS System)
‚îÇ   ‚îú‚îÄ‚îÄ element_system.py         # –°–∏—Å—Ç–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å—Ç–∏—Ö–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ mana_system.py            # –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞–Ω–æ–π (ECS System)
‚îú‚îÄ‚îÄ effects/
‚îÇ   ‚îú‚îÄ‚îÄ spell_effects.py          # –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ particle_system.py        # –°–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—Ü –¥–ª—è –º–∞–≥–∏–∏
‚îî‚îÄ‚îÄ events/
    ‚îî‚îÄ‚îÄ magic_events.py           # –°–æ–±—ã—Ç–∏—è –º–∞–≥–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã
```

### –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è
- `src/core/ecs/magic_components.py` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–∞–≥–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã
- `src/magic/spell_strategies.py` - —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- `src/magic/spell_decorators.py` - –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- `src/magic/magic_system.py` - –æ—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞–≥–∏–∏ (ECS System)
- `src/magic/mana_system.py` - —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞–Ω–æ–π (ECS System)
- `src/effects/spell_effects.py` - –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- `src/events/magic_events.py` - —Å–æ–±—ã—Ç–∏—è –º–∞–≥–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã
- `src/entities/player.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `src/ui/mana_bar.py` - –ø–æ–ª–æ—Å–∫–∞ –º–∞–Ω—ã –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –ö–ª–∞—Å—Å—ã –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
```python
# –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
class Spell:
    def __init__(self, element, mana_cost, damage, range, cooldown):
        pass

class FireBolt(Spell):
    # –û–≥–Ω–µ–Ω–Ω—ã–π —Å–Ω–∞—Ä—è–¥
    pass

class IceShield(Spell):
    # –õ–µ–¥—è–Ω–æ–π —â–∏—Ç
    pass

class LightningStrike(Spell):
    # –£–¥–∞—Ä –º–æ–ª–Ω–∏–∏
    pass
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```ini
[MAGIC]
max_mana = 100
mana_regen_rate = 1.0
spell_cooldown_base = 500

[SPELLS]
fire_bolt_cost = 15
ice_shield_cost = 20
lightning_strike_cost = 25
combo_multiplier = 1.5
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–æ–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–∫–ª–∞–≤–∏—à–∏ –¥–ª—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è)
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π (–∏–∑—É—á–µ–Ω–Ω—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è, –º–∞–Ω–∞)

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [ ] –ò–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ 3 —Å—Ç–∏—Ö–∏–∏
- [ ] –ú–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ç—Ä–∞—Ç–∏—Ç—Å—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- [ ] –ö–æ–º–±–æ-—ç—Ñ—Ñ–µ–∫—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
- [ ] –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –°–∏—Å—Ç–µ–º–∞ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ (–Ω–µ —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–∞—è/—Å–ª–∞–±–∞—è)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å UI —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
**–í—ã—Å–æ–∫–∏–π** - –ö–ª—é—á–µ–≤–∞—è –∏–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –¢–µ–∫—É—â–∞—è –±–æ–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
- –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- UI —Å–∏—Å—Ç–µ–º–∞

## –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
- –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –¥–æ–ª–∂–Ω–∞ —Ç—Ä–µ–±–æ–≤–∞—Ç—å —Ç–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–æ–º–±–æ-—ç—Ñ—Ñ–µ–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–æ—â–Ω—ã–º–∏, –Ω–æ –¥–æ—Ä–æ–≥–∏–º–∏
- –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞–Ω—ã –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ–π
- –ö—É–ª–¥–∞—É–Ω—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å —Å–ø–∞–º –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π

## –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
2-3 –Ω–µ–¥–µ–ª–∏

## –°–≤—è–∑–∞–Ω–Ω—ã–µ issues
- #04 (–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ—Ä—É–∂–∏–µ) - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–∞–≥–∏–∏ —Å –æ—Ä—É–∂–∏–µ–º
- #06 (–î–µ—Ä–µ–≤–æ –Ω–∞–≤—ã–∫–æ–≤) - –≤–µ—Ç–∫–∞ –º–∞–≥–∏–∏
- #08 (–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å) - –º–∞–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã –∏ –∑–µ–ª—å—è –º–∞–Ω—ã

---

## –ü–æ–¥–∑–∞–¥–∞—á–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### üîÆ –§–∞–∑–∞ 1: –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞–Ω—ã
**–¶–µ–ª—å**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞ –º–∞–Ω—ã –∫ –∏–≥—Ä–æ–∫—É

#### 1.1 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–∞–Ω—ã ECS
- [ ] –†–∞—Å—à–∏—Ä–∏—Ç—å `src/entities/player.py` - –¥–æ–±–∞–≤–∏—Ç—å ManaComponent
- [ ] –°–æ–∑–¥–∞—Ç—å `src/core/ecs/mana_components.py` - ManaComponent, ManaRegenerationComponent
- [ ] –°–æ–∑–¥–∞—Ç—å `test_mana_components.py` - unit —Ç–µ—Å—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –º–∞–Ω—ã
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –∏–≥—Ä–æ–∫–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç —Å –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –º–∞–Ω—ã

#### 1.2 UI –¥–ª—è –º–∞–Ω—ã
- [ ] –°–æ–∑–¥–∞—Ç—å `src/ui/mana_bar.py` - –ø–æ–ª–æ—Å–∫–∞ –º–∞–Ω—ã (—Å–∏–Ω–µ-—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π HUD –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–∞–Ω—ã
- [ ] –°–æ–∑–¥–∞—Ç—å `test_mana_ui.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI –º–∞–Ω—ã
- [ ] –ü–æ–ª–æ—Å–∫–∞ –º–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

#### 1.3 –°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∞–Ω—ã
- [ ] –°–æ–∑–¥–∞—Ç—å ManaRegenerationSystem (ECS System)
- [ ] –°–æ–∑–¥–∞—Ç—å `test_mana_regeneration.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- [ ] –ú–∞–Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º

### üî• –§–∞–∑–∞ 2: –°–∏—Å—Ç–µ–º–∞ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∏—Ö–∏–π
**–¶–µ–ª—å**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ—Ö —Å—Ç–∏—Ö–∏–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏

#### 2.1 –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç–∏—Ö–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `src/core/ecs/spell_components.py` - SpellComponent, ElementComponent
- [ ] –°–æ–∑–¥–∞—Ç—å FireComponent, IceComponent, LightningComponent
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_components.py` - unit —Ç–µ—Å—Ç—ã –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å—Ç–∏—Ö–∏–π
- [ ] –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç–∏—Ö–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

#### 2.2 Strategy Pattern –¥–ª—è —Å—Ç–∏—Ö–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `src/magic/element_strategies.py` - ElementStrategy, FireStrategy, IceStrategy, LightningStrategy
- [ ] –°–æ–∑–¥–∞—Ç—å `test_element_strategies.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å—Ç–∏—Ö–∏–π
- [ ] –ö–∞–∂–¥–∞—è —Å—Ç–∏—Ö–∏—è –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∏ —É—Ä–æ–Ω

#### 2.3 –°–∏—Å—Ç–µ–º–∞ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Å—Ç–∏—Ö–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `src/rendering/spell_effects.py` - –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–∏—Ö–∏–∏
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_effects.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- [ ] –ö–∞–∂–¥–∞—è —Å—Ç–∏—Ö–∏—è –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

### ‚ö° –§–∞–∑–∞ 3: –°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
**–¶–µ–ª—å**: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –∫–∞–∫ –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

#### 3.1 –§–∞–±—Ä–∏–∫–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `src/factories/spell_factory.py` - SpellFactory, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–±—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç–∏—Ö–∏–∏
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_factory.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –ó–∞–∫–ª–∏–Ω–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å–æ –≤—Å–µ–º–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

#### 3.2 –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å SpellCastingSystem (ECS System)
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_casting.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –ó–∞–∫–ª–∏–Ω–∞–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–∞—Å—Ö–æ–¥–æ–º –º–∞–Ω—ã –∏ –∫—É–ª–¥–∞—É–Ω–æ–º

#### 3.3 –°–∏—Å—Ç–µ–º–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- [ ] –°–æ–∑–¥–∞—Ç—å SpellEffectSystem (ECS System) 
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_effects_system.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –ó–∞–∫–ª–∏–Ω–∞–Ω–∏—è –Ω–∞–Ω–æ—Å—è—Ç —É—Ä–æ–Ω –∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞—é—Ç —Å—Ç–∞—Ç—É—Å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

### üéØ –§–∞–∑–∞ 4: –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∏—Ö–∏–π  
**–¶–µ–ª—å**: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å—Ç–∏—Ö–∏—è–º–∏

#### 4.1 –°–∏—Å—Ç–µ–º–∞ —ç–ª–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `src/magic/elemental_reactions.py` - —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–∫—Ü–∏–π –º–µ–∂–¥—É —Å—Ç–∏—Ö–∏—è–º–∏
- [ ] –°–æ–∑–¥–∞—Ç—å `test_elemental_reactions.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–π
- [ ] –û–≥–æ–Ω—å + –•–æ–ª–æ–¥ –¥–∞—é—Ç —É—Å–∏–ª–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç, –¥—Ä—É–≥–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

#### 4.2 –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `src/magic/spell_modifiers.py` - Decorator Pattern –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_modifiers.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
- [ ] –ó–∞–∫–ª–∏–Ω–∞–Ω–∏—è –º–æ–∂–Ω–æ —É—Å–∏–ª–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã

### üéÆ –§–∞–∑–∞ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
**–¶–µ–ª—å**: –ü—Ä–∏–≤—è–∑–∫–∞ –º–∞–≥–∏–∏ –∫ –∫–ª–∞–≤–∏—à–∞–º –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

#### 5.1 –°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –∫–ª–∞–≤–∏—à –¥–ª—è –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –≤–≤–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–ª–∞–≤–∏—à –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (1-9)
- [ ] –°–æ–∑–¥–∞—Ç—å `src/ui/spell_hotbar.py` - –ø–∞–Ω–µ–ª—å –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_hotkeys.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à
- [ ] –ò–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è —á–µ—Ä–µ–∑ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏

#### 5.2 –°–∏—Å—Ç–µ–º–∞ –≤—ã–±–æ—Ä–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `src/ui/spell_selection.py` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–±–æ—Ä–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –°–æ–∑–¥–∞—Ç—å `test_spell_selection.py` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –ò–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∫–∞–∫–∏–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å –Ω–∞ –∫–ª–∞–≤–∏—à–∏

### üîß –§–∞–∑–∞ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
**–¶–µ–ª—å**: –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 6.1 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã –º–∞–≥–∏–∏
- [ ] –°–æ–∑–¥–∞—Ç—å `tests/integration/test_magic_system_integration.py`
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –≤—ã–±–æ—Ä –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è ‚Üí –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ ‚Üí —ç—Ñ—Ñ–µ–∫—Ç—ã ‚Üí —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞–Ω—ã
- [ ] –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

#### 6.2 –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∏–∏ –≤ `config.ini` - —É—Ä–æ–Ω, —Å—Ç–æ–∏–º–æ—Å—Ç—å –º–∞–Ω—ã, –∫—É–ª–¥–∞—É–Ω—ã
- [ ] –°–æ–∑–¥–∞—Ç—å `test_magic_balance.py` - —Ç–µ—Å—Ç—ã –∏–≥—Ä–æ–≤–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
- [ ] –°–∏—Å—Ç–µ–º–∞ –º–∞–≥–∏–∏ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫

#### 6.3 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –º–∞–≥–∏–∏
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `CLAUDE.md` —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π —Å–∏—Å—Ç–µ–º—ã –º–∞–≥–∏–∏  
- [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
- [ ] –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

---

## üå≥ –î–µ—Ä–µ–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ–¥–∑–∞–¥–∞—á

```
–§–∞–∑–∞ 1: –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∞–Ω—ã
‚îú‚îÄ‚îÄ 1.1 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–∞–Ω—ã ECS
‚îú‚îÄ‚îÄ 1.2 UI –¥–ª—è –º–∞–Ω—ã (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 1.1)
‚îî‚îÄ‚îÄ 1.3 –°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 1.1)

–§–∞–∑–∞ 2: –°–∏—Å—Ç–µ–º–∞ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∏—Ö–∏–π
‚îú‚îÄ‚îÄ 2.1 –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç–∏—Ö–∏–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 1.1)
‚îú‚îÄ‚îÄ 2.2 Strategy Pattern –¥–ª—è —Å—Ç–∏—Ö–∏–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 2.1)
‚îî‚îÄ‚îÄ 2.3 –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 2.1, 2.2)

–§–∞–∑–∞ 3: –°–∏—Å—Ç–µ–º–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π
‚îú‚îÄ‚îÄ 3.1 –§–∞–±—Ä–∏–∫–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 2.1, 2.2)
‚îú‚îÄ‚îÄ 3.2 –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 3.1, 1.3)
‚îî‚îÄ‚îÄ 3.3 –°–∏—Å—Ç–µ–º–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 3.2, 2.3)

–§–∞–∑–∞ 4: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∏—Ö–∏–π
‚îú‚îÄ‚îÄ 4.1 –≠–ª–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 3.3, 2.2)
‚îî‚îÄ‚îÄ 4.2 –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 3.1, 4.1)

–§–∞–∑–∞ 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
‚îú‚îÄ‚îÄ 5.1 –ë—ã—Å—Ç—Ä—ã–µ –∫–ª–∞–≤–∏—à–∏ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 3.2, 1.2)
‚îî‚îÄ‚îÄ 5.2 –í—ã–±–æ—Ä –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 5.1)

–§–∞–∑–∞ 6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
‚îú‚îÄ‚îÄ 6.1 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ñ–∞–∑)
‚îú‚îÄ‚îÄ 6.2 –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç 6.1)
‚îî‚îÄ‚îÄ 6.3 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ñ–∞–∑)
```

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å**: 1.1 ‚Üí 1.2 ‚Üí 1.3 ‚Üí 2.1 ‚Üí 2.2 ‚Üí 3.1 ‚Üí 3.2 ‚Üí 3.3 ‚Üí 6.1 ‚Üí 6.2 ‚Üí 6.3

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**: 
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –º–∞–≥–∏–∏ –∏ —Å—Ç–∏—Ö–∏–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∏–≥—Ä–æ–∫–æ–º –∏ –≤—Ä–∞–≥–∞–º–∏
- –¢–µ—Å—Ç—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ —É—Ä–æ–Ω–∞
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: 90% –¥–ª—è –≤—Å–µ—Ö –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤