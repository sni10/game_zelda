# Черновик планов расширения игры

## 0. Система магии
### Магические стихии
- **Огонь** - урон + дебаф к холоду
- **Холод** - урон + дебаф к огню  
- **Молния** - урон + возможные дополнительные эффекты

### Типы магических атак
- **Дальний урон** - снаряды, лучи
- **Ближний урон** - магические улучшения оружия, взрывы вокруг игрока

## 1. Система оружия и боя
### Текущее состояние
- Игрок умеет наносить ближний урон (базовая атака)

### Планируемые типы оружия
- **Меч** (классика) - одна рука
- **Два меча** - обе руки, быстрые атаки
- **Арбалет** - обе руки, дальний урон

### Магические заклинания в руках
- **Каждая рука** может содержать заклинание одной из 3 стихий
- **Комбинирование стихий**:
  - Огонь + Холод = супер комбо
  - Различные сочетания для разных эффектов
- **Игровой баланс** - продумать ограничения и кулдауны

## 2. Система защиты
### Щит
- **Физический щит** в руке - блокирует атаки
- **Магический щит** - заклинание на 5 минут
  - Полная блокировка дальнего урона
  - Полная блокировка ближнего урона

## 3. Система NPC и врагов
### Ходячие NPC (2 вида)
- **Стрелок** - дальние атаки, патрулирование
- **Мечник** - ближние атаки, патрулирование

### Бегающие NPC
- **Быстрый боец** - ближний урон
- Тактика: подбегает издалека → несколько ударов → убегает
- Игрок может блокировать или получить урон

## 4. Система событий и интерактивных объектов
### Event boxes на карте
- **Переходы между картами**
- **Спаун врагов** - внезапное появление из "кустов"
- **Магазины** (для будущих версий)
- **Сундуки с лутом**
- **Активация квестов**
- **Головоломки и переключатели**

## 5. Система прокачки и скиллов
### Структура дерева навыков
Вдохновение: Dark Messiah of Might and Magic

#### Основные ветки развития
1. **Ветка магии** - 3 скилла
   - Увеличение объема магии (маны)
   - Усиление магического урона
   - Продление действия заклинаний

2. **Ветка ближнего боя** - 3 скилла
   - Увеличение урона ближнего оружия
   - Скорость атак
   - Критический урон

3. **Ветка дальнего боя** - 3 скилла
   - Увеличение урона дальнего оружия
   - Точность и дальность стрельбы
   - Скорость перезарядки

4. **Ветка выносливости** - 3 скилла
   - Увеличение здоровья (HP)
   - Регенерация здоровья
   - Устойчивость к дебафам

### Система опыта
- Опыт за убийство врагов
- Опыт за выполнение квестов
- Опыт за исследование мира

## 6. Инвентарь и предметы
### Расходуемые предметы (зелья)
- **Зелье здоровья** - мгновенное восстановление HP
- **Зелье магии** - мгновенное восстановление маны
- **Комбо-зелье** - восстановление HP и маны
- **Зелье силы** - временное усиление урона
- **Зелье защиты** - временная "крепкая кожа", увеличение защиты

### Экипировка
- **Оружие** - мечи, арбалеты, магические посохи
- **Броня** - увеличение защиты и здоровья
- **Аксессуары** - кольца, амулеты

### Система улучшений (как в Diablo 2/3)
- **Руны и камни** - улучшение характеристик оружия и брони
- **Гнезда для камней** в оружии и броне
- **Крафтинг** - создание и улучшение предметов

## 7. Система множественных миров и карт
### Концепция миров
- **Основной мир** - текущая карта 2000x2000 (стартовая локация)
- **Дополнительные миры** - новые карты различных размеров и тематик
- **Связь между мирами** - система телепортации через порталы

### Система телепортации
- **Тайл портала** - специальный тип почвы с визуальным эффектом
- **Привязка к миру** - каждый портал ведет в конкретный мир
- **Интерактивность** - игрок выбирает мир для загрузки при взаимодействии с порталом
- **Двусторонние порталы** - возможность возврата в исходный мир

### Экраны загрузки с историей
- **Красивые заставки** - картинки для каждого перехода между мирами
- **Повествование** - интересная история рассказывается по частям
- **Прогрессивная история** - каждый переход открывает новую главу
- **Время загрузки** - используется для показа истории и создания атмосферы

### Примеры миров
- **Мир-пещера** - карта окружена горами, внутри травяные поля с тоннелями
- **Подземный мир** - темная карта с лавой и особыми врагами
- **Ледяной мир** - заснеженная карта с ледяными препятствиями
- **Лесной мир** - густой лес с деревьями и скрытыми тропами

## 8. Система высоты и тоннелей (Z-координата)
### Концепция многоуровневого ландшафта
- **Z-координата** - введение третьего измерения для симуляции высоты
- **Визуальная глубина** - тайлы могут перекрывать друг друга
- **Игровая механика** - игрок может находиться "под" или "над" определенными тайлами

### Система тоннелей
#### Структура тоннеля
- **Вход в тоннель** - специальный тайл-триггер
- **Подземный уровень** - игрок перемещается на Z-уровень -1
- **Перекрывающие тайлы** - травяные тайлы на Z-уровне 0 скрывают игрока
- **Выход из тоннеля** - возврат на базовый Z-уровень 0

#### Технические особенности
- **Размер тоннелей** - от 2 до 5 клеток в длину
- **Ширина прохода** - 2 клетки (узкая полоса)
- **Стены пещеры** - ограничения движения по бокам тоннеля
- **Визуальная обратная связь** - игрок частично скрыт травой при движении в тоннеле

#### Пример реализации для мира-пещеры
- **Карта окружена горами** - естественные границы
- **Внутри травяные поля** - базовый Z-уровень 0
- **3 тоннеля разной длины**:
  - Короткий (2 клетки) - простой проход
  - Средний (3-4 клетки) - с поворотом
  - Длинный (5 клеток) - прямой, возможно с сокровищем в середине
- **Порталы-телепорты** - для перехода в другие миры

### Система рендеринга по слоям
- **Z-уровень -1** - подземные тоннели
- **Z-уровень 0** - базовый уровень игры
- **Z-уровень +1** - перекрывающие элементы (верхушки деревьев, мосты)
- **Сортировка по глубине** - правильный порядок отрисовки

### Расширенная механика высоты
- **Мосты** - игрок может проходить под ними и по ним
- **Многоуровневые здания** - лестницы между этажами
- **Водопады и обрывы** - визуальные эффекты глубины
- **Летающие враги** - существа на разных Z-уровнях

## Приоритеты реализации
1. **Высокий приоритет**: Система магии и оружия, система миров
2. **Средний приоритет**: NPC и система событий, базовая Z-координата
3. **Низкий приоритет**: Детальная система прокачки, продвинутые тоннели и многоуровневость

## Технические заметки
- Все новые системы должны интегрироваться с существующей архитектурой
- Конфигурация новых параметров через config.ini
- Модульная структура для легкого тестирования
- Соблюдение принципов SOLID и DRY
- **Система координат**: добавление Z-координаты к существующей X,Y системе
- **Производительность**: оптимизация рендеринга многослойных тайлов
- **Сохранения**: расширение формата для хранения данных о мирах и Z-координатах